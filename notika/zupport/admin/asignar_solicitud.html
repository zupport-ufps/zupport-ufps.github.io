
 <!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Perfil de Administrador| Zupport</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- favicon
        ============================================ -->
    <link rel="shortcut icon" type="image/x-icon" href="../../img/favicon.ico">
    <!-- Google Fonts
        ============================================ -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,700,900" rel="stylesheet">
    <!-- Bootstrap CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/bootstrap.min.css">
    <!-- font awesome CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/font-awesome.min.css">
    <!-- owl.carousel CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/owl.carousel.css">
    <link rel="stylesheet" href="../../css/owl.theme.css">
    <link rel="stylesheet" href="../../css/owl.transitions.css">
    <!-- meanmenu CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/meanmenu/meanmenu.min.css">
    <!-- animate CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/animate.css">
    <!-- normalize CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/normalize.css">
    <!-- mCustomScrollbar CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/scrollbar/jquery.mCustomScrollbar.min.css">
    <!-- Notika icon CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/notika-custom-icon.css">
    <!-- wave CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/wave/waves.min.css">
    <link rel="stylesheet" href="../../css/wave/button.css">
    <!-- bootstrap select CSS
    ============================================ -->
    <link rel="stylesheet" href="../../css/bootstrap-select/bootstrap-select.css">
    <!-- main CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/main.css">
    <!-- style CSS
        ============================================ -->
    <link rel="stylesheet" href="../../style.css">
    <!-- responsive CSS
        ============================================ -->
    <link rel="stylesheet" href="../../css/responsive.css">
    <!-- modernizr JS
        ============================================ -->
    <script src="../../js/vendor/modernizr-2.8.3.min.js"></script>
</head>

<body>
    <div id="app">
      <!--[if lt IE 8]>
              <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
          <![endif]-->
      <!-- Start Header Top Area -->
      <div class="header-top-area">
          <div class="container">
              <div class="row">
                  <div class="col-xs-12 text-center">
                      <div class="logo-area">
                          <img src="../../img/logo/logo.png" alt="logo"/>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      <!-- End Header Top Area -->
      <!-- Mobile Menu start -->
      <div class="mobile-menu-area">
          <div class="container">
              <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                      <div class="mobile-menu">
                          <nav id="dropdown">
                              <ul class="mobile-menu-nav">
                                  <li><a data-toggle="collapse" data-target="#Pagemob" href="#">Empresa</a>
                                      <ul id="Pagemob" class="collapse dropdown-header-top">
                                          <li><a href="nueva_empresa.html">Nueva</a>
                                          </li>
                                          <li><a href="empresas.html">Todas las empersas</a>
                                          </li>
                                      </ul>
                                  </li>
                                  <li><a data-toggle="collapse" data-target="#Pagemob" href="#">Staff</a>
                                      <ul id="Pagemob" class="collapse dropdown-header-top">
                                          <li><a href="nuevo_usuario.html">Registrar usuario</a>
                                          </li>
                                          <li><a href="solicitudes_libres.html">Asignar solicitudes</a>
                                          </li>
                                      </ul>
                                  </li>
                                  <li><a data-toggle="collapse" data-target="#profile">Perfil</a>
                                      <ul id="demoevent" class="collapse dropdown-header-top">
                                          <li><a href="perfil.html">Mi perfil</a></li>
                                          <li><a id="logout" href="">Salir</a></li>
                                      </ul>
                                  </li>
                              </ul>
                          </nav>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      <!-- Mobile Menu end -->
      <!-- Main Menu area start-->
      <div class="main-menu-area mg-tb-40">
          <div class="container">
              <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                      <ul class="nav nav-tabs notika-menu-wrap menu-it-icon-pro">
                          <li><a data-toggle="tab" href="#Page"><i class="notika-icon notika-edit"></i> Empresa</a>
                          </li>
                          <li class="active"><a data-toggle="tab" href="#asesores"><i class="notika-icon notika-support"></i> Staff</a>
                          </li>
                          <li><a data-toggle="tab" href="#profile"><i class="notika-icon notika-support"></i> Perfil</a>
                          </li>
                      </ul>
                      <div class="tab-content custom-menu-content">
                          <div id="Page" class="tab-pane notika-tab-menu-bg animated flipInX">
                              <ul class="notika-main-menu-dropdown">
                                <li><a href="nueva_empresa.html">Nueva</a>
                                </li>
                                <li><a href="empresas.html">Todas las empersas</a>
                                </li>
                              </ul>
                          </div>
                          <div id="asesores" class="active tab-pane notika-tab-menu-bg animated flipInX">
                              <ul class="notika-main-menu-dropdown">
                                <li><a href="nuevo_usuario.html">Registrar Staff</a>
                                </li>
                                <li><a href="solicitudes_libres.html">Asignar solicitudes</a>
                                </li>
                              </ul>
                          </div>
                          <div id="profile" class="tab-pane notika-tab-menu-bg animated flipInX">
                              <ul class="notika-main-menu-dropdown">
                                  <li><a href="perfil.html">Mi perfil</a>
                                  </li>
                                  <li><a id="logout" href="" v-on:click="logout()">Salir</a>
                                  </li>
                              </ul>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      <!-- Main Menu area End-->

      <!-- Breadcomb area Start-->
      <div class="breadcomb-area">
    		<div class="container">
    			<div class="row">
    				<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    					<div class="breadcomb-list">
    						<div class="row">
    							<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    								<div class="breadcomb-wp">
    									<div class="breadcomb-icon">
    										<i class="notika-icon notika-app"></i>
    									</div>
    									<div class="breadcomb-ctn">
    										<h2>Consulta sin asignar</h2>
    										<p>La información detallada de la consulta sin asignar</p>
    									</div>
    								</div>
    							</div>
    						</div>
    					</div>
    				</div>
    			</div>
    		</div>
    	</div>
    	<!-- Breadcomb area End-->

      <!-- Area Start-->
      <div class="invoice-area">
          <div class="container">
              <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                      <div class="invoice-wrap">
                        <div class="invoice-img">
                          <h3 style="color: #fff; text-align: center;">{{ info.asunto }}</h3>
                        </div>
                        <div class="invoice-hds-pro">
                          <br>
                          <p>Descripcion de su solicitud: </p>
                          <p>{{ info.descripcion }}</p>
                          <br>
                          <p>Autor: {{ info.autor.nombre }} {{ info.autor.apellido }}</p>
                          <p>Registrada a la empresa: {{ info.empresa.nombre }}</p>

                          <div style="text-align:right;">
                            <p>{{ info.timestamp | moment}}</p>
                          </div>
                          <hr>
                        </div>
                        <div class="invoice-hds-pro">
                          <h3>Asignar asesor</h3>
                          <div class="form-group">
                            <select class="form-control" v-model="asesor">
                              <option v-for="as in asesores" v-bind:value="as.asesor.id">{{ as.asesor.nombre }} {{ as.asesor.apellido }}</option>
                            </select>
                          </div>
                          <div style="text-align:right;">
                            <a class="btn btn-success notika-btn-success" v-on:click="asignar()">Asignar</a>
                          </div>
                          <hr>
                        </div>
                        <div class="invoice-hds-pro">
                          <h3>Comentarios</h3>
                          <br>
                        </div>
                        <div v-if="comentarios.length == 0">
                          <span style="text-align:center;">Aún no se han registrado comentarios</span>
                          <hr>
                        </div>
                        <div v-for="comentario in comentarios">
                          <h4 style="color: #032a1e;"> {{ comentario.autor.nombre }} {{ comentario.autor.apellido }} </h4>
                          <p v-if="comentario.autor.rol == '0'">(Autor)</p>
                          <p v-if="comentario.autor.rol == '1'">(Asesor)</p>
                          <p>{{ comentario.info }}</p>
                          <p style="text-align:right">{{ comentario.timestamp | moment}}</p>
                          <hr>
                        </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>

      <!-- Start Footer area-->
        <div class="footer-copyright-area">
          <div class="container">
              <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                      <div class="footer-copy-right">
                          <p>Copyright © 2018
  . All rights reserved. Template by <a href="https://colorlib.com">Colorlib</a>.</p>
                      </div>
                  </div>
              </div>
          </div>
        </div>
      <!-- End Footer area-->
      </div>

    <!-- jquery
        ============================================ -->
    <script src="../../js/vendor/jquery-1.12.4.min.js"></script>
    <!-- bootstrap JS
        ============================================ -->
    <script src="../../js/bootstrap.min.js"></script>
    <!-- wow JS
        ============================================ -->
    <script src="../../js/wow.min.js"></script>
    <!-- price-slider JS
        ============================================ -->
    <script src="../../js/jquery-price-slider.js"></script>
    <!-- owl.carousel JS
        ============================================ -->
    <script src="../../js/owl.carousel.min.js"></script>
    <!-- scrollUp JS
        ============================================ -->
    <script src="../../js/jquery.scrollUp.min.js"></script>
    <!-- meanmenu JS
        ============================================ -->
    <script src="../../js/meanmenu/jquery.meanmenu.js"></script>
    <!-- counterup JS
        ============================================ -->
    <script src="../../js/counterup/jquery.counterup.min.js"></script>
    <script src="../../js/counterup/waypoints.min.js"></script>
    <script src="../../js/counterup/counterup-active.js"></script>
    <!-- mCustomScrollbar JS
        ============================================ -->
    <script src="../../js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
    <!-- sparkline JS
        ============================================ -->
    <script src="../../js/sparkline/jquery.sparkline.min.js"></script>
    <script src="../../js/sparkline/sparkline-active.js"></script>
    <!-- flot JS
        ============================================ -->
    <script src="../../js/flot/jquery.flot.js"></script>
    <script src="../../js/flot/jquery.flot.resize.js"></script>
    <script src="../../js/flot/flot-active.js"></script>
    <!-- knob JS
        ============================================ -->
    <script src="../../js/knob/jquery.knob.js"></script>
    <script src="../../js/knob/jquery.appear.js"></script>
    <script src="../../js/knob/knob-active.js"></script>
    <!--  wave JS
        ============================================ -->
    <script src="../../js/wave/waves.min.js"></script>
    <script src="../../js/wave/wave-active.js"></script>
    <!-- icheck JS
        ============================================ -->
    <script src="../../js/icheck/icheck.min.js"></script>
    <script src="../../js/icheck/icheck-active.js"></script>
    <!--  todo JS
        ============================================ -->
    <script src="../../js/todo/jquery.todo.js"></script>
    <!-- plugins JS
        ============================================ -->
    <script src="../../js/plugins.js"></script>
    <!-- main JS
        ============================================ -->
    <script src="../../js/main.js"></script>

    <!-- bootstrap select JS
		============================================ -->
    <script src="../../js/bootstrap-select/bootstrap-select.js"></script>

    <!-- Moment JS
    ============================================ -->
    <script src="../../js/moment.js"></script>

    <!-- Vue.js
    ============================================ -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>


  <!-- falta este pedazome voy a dormir tengo previo a las 6-->
    <!-- falta este pedazome voy a dormir tengo previo a las 6-->
      <!-- falta este pedazome voy a dormir tengo previo a las 6-->
      <script type="text/javascript">
        new Vue({
          el: '#app',
          data () {
            return {
              info: null,
              asesores: null,
              asesor: null,
              comentarios: null
            }
          },
          mounted () {
            axios.all([
              axios.get('https://zupport.herokuapp.com/ayuda/solicitud/'+localStorage.getItem('id_solicitud')+'/', {
                headers: {
                  'Authorization': "Token "+localStorage.getItem('token')
                }
              }),
              axios.get('https://zupport.herokuapp.com/ayuda/solicitud/'+localStorage.getItem('id_solicitud')+'/comentarios/', {
                headers: {
                  'Authorization': "Token "+localStorage.getItem('token')
                }
              }),
              axios.get('https://zupport.herokuapp.com/empresa/'+localStorage.getItem('id_empresa')+'/asesores/', {
                headers: {
                  'Authorization': "Token "+localStorage.getItem('token')
                }
              })
            ]).then(
              axios.spread(
                (response1, response2, response3) => {
                  this.info = response1.data
                  this.comentarios = response2.data
                  this.asesores = response3.data
                }
              )
            ).catch(error => {
              console.log(error);
            });
          },
          filters: {
            moment: function (date) {
              moment.locale('es')
              return moment(date).format('[Publicado el] dddd D [de] MMMM [del] YYYY [a las] h:mm a');
            }
          },
          methods: {
            logout: function () {
              localStorage.clear();
            },
            asignar: function() {
              axios.post(
                'https://zupport.herokuapp.com/ayuda/solicitud/asesor/',
                {
                  asesor_id: this.asesor,
                  consulta_id: localStorage.getItem('id_solicitud')
                },
                {
                  headers: {
                    'Authorization': "Token "+localStorage.getItem('token')
                  }
                }
              ).then(
                response => {
                  if (response.status == 201) {
                    window.location.href = "solicitudes_libres.html";
                  }
                }
              ).catch(
                error => {
                  if (error.response.status == 401) {
                    console.log("Credenciales incorrectas");
                  }
                }
              );
            }
          }
        })
      </script>
</body>
</html>
